---
title: "Kendall-tau & Pearson Correlation Comparisons"
author: "Robert M Flight"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: pdf_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
theme_set(cowplot::theme_cowplot())
```

## Purpose

Quick report comparing our the missing data aware Kendall-tau and previous implementation of weighted Pearson correlations.

## Data

Positive and negative correlating vectors where:

  * x = 1 - 10
  * y = 1 - 10
  * y2 = 10 - 1
  * Values in x and y replaced by NA values, from 1 to 10 in either one
  
Pearson correlations used the "locally-it-weighted" function, Kendall-tau were calculated using "global", without scaling for "max-cor".
  
## Results

### Pearson

```{r pearson}
loadd(positive_pearson)
loadd(negative_pearson)

pearson_df = data.frame(positive = positive_pearson, negative = negative_pearson) %>%
  dplyr::mutate(diff = positive - -1 * negative) %>%
  dplyr::filter(!is.na(positive), !is.na(negative))
```

```{r plot_pearson, dev='CairoPNG', dpi=300}
ggplot(pearson_df, aes(x = positive, y = negative)) + geom_point()
```

```{r plot_pearson2}
pearson_long_df = tidyr::pivot_longer(pearson_df, -diff, names_to = "type", values_to = "correlation")
ggplot(pearson_long_df, aes(x = correlation)) + geom_histogram(bins = 100) + 
  facet_wrap(~ type, ncol = 1)
```

```{r summary_pearson}
dplyr::group_by(pearson_long_df, type) %>%
  dplyr::summarise(mean = (mean(correlation, na.rm = TRUE))) %>%
  knitr::kable()
```

### Kendall-tau

```{r kendall}
loadd(positive_kt)
loadd(negative_kt)

kt_df = data.frame(positive = positive_kt, negative = negative_kt) %>%
  dplyr::mutate(diff = positive - -1 * negative) %>%
  dplyr::filter(!is.na(positive), !is.na(negative))
```

```{r plot_kt, dev='CairoPNG', dpi = 300}
ggplot(kt_df, aes(x = positive, y = negative)) + geom_point()
```

```{r plot_kt2}
kt_long_df = tidyr::pivot_longer(kt_df, -diff, names_to = "type", values_to = "correlation")
ggplot(kt_long_df, aes(x = correlation)) + geom_histogram(bins = 100) + 
  facet_wrap(~ type, ncol = 1)
```

```{r summary_kt}
dplyr::group_by(kt_long_df, type) %>%
  dplyr::summarise(mean = (mean(correlation, na.rm = TRUE))) %>%
  knitr::kable()
```
